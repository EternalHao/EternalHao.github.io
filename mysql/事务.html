<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>blog</title>
    <meta name="description" content="Vuepress blog demo">
    
    
    <link rel="preload" href="/assets/css/0.styles.e12d9437.css" as="style"><link rel="preload" href="/assets/js/app.702528d9.js" as="script"><link rel="preload" href="/assets/js/2.bc0a9366.js" as="script"><link rel="preload" href="/assets/js/19.8eac0218.js" as="script"><link rel="prefetch" href="/assets/js/10.189532b9.js"><link rel="prefetch" href="/assets/js/11.40dc7aad.js"><link rel="prefetch" href="/assets/js/12.4155dd95.js"><link rel="prefetch" href="/assets/js/13.8a25e8dd.js"><link rel="prefetch" href="/assets/js/14.742193af.js"><link rel="prefetch" href="/assets/js/15.eb8951e8.js"><link rel="prefetch" href="/assets/js/16.300d77c3.js"><link rel="prefetch" href="/assets/js/17.f9e887bb.js"><link rel="prefetch" href="/assets/js/18.72e5452b.js"><link rel="prefetch" href="/assets/js/20.698aa3d9.js"><link rel="prefetch" href="/assets/js/21.df54a1e3.js"><link rel="prefetch" href="/assets/js/22.202bc424.js"><link rel="prefetch" href="/assets/js/23.dcdfe1c2.js"><link rel="prefetch" href="/assets/js/24.e5dfe154.js"><link rel="prefetch" href="/assets/js/3.819e11ff.js"><link rel="prefetch" href="/assets/js/4.b2f530cc.js"><link rel="prefetch" href="/assets/js/5.e6bf6ba4.js"><link rel="prefetch" href="/assets/js/6.ddcd92ff.js"><link rel="prefetch" href="/assets/js/7.d7bcaf4d.js"><link rel="prefetch" href="/assets/js/8.68952ef1.js"><link rel="prefetch" href="/assets/js/9.17a8032f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e12d9437.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/FirstBlog.html" class="nav-link">FirstBlog</a></div><div class="nav-item"><a href="/blog/Resume.html" class="nav-link">轻松面试</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">MySql</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/索引.html" class="nav-link">索引</a></li><li class="dropdown-item"><!----> <a href="/mysql/锁.html" class="nav-link">锁</a></li><li class="dropdown-item"><!----> <a href="/mysql/事务.html" class="nav-link">事务</a></li><li class="dropdown-item"><!----> <a href="/mysql/优化.html" class="nav-link">优化</a></li><li class="dropdown-item"><!----> <a href="/mysql/基础SQL语句.html" class="nav-link">基础SQL语句</a></li><li class="dropdown-item"><!----> <a href="/mysql/.html" class="nav-link"></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">缓存</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Redis.html" class="nav-link">Redis</a></li></ul></div></div> <a href="https://github.com/EternalHao" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/blog/FirstBlog.html" class="nav-link">FirstBlog</a></div><div class="nav-item"><a href="/blog/Resume.html" class="nav-link">轻松面试</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">MySql</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/索引.html" class="nav-link">索引</a></li><li class="dropdown-item"><!----> <a href="/mysql/锁.html" class="nav-link">锁</a></li><li class="dropdown-item"><!----> <a href="/mysql/事务.html" class="nav-link">事务</a></li><li class="dropdown-item"><!----> <a href="/mysql/优化.html" class="nav-link">优化</a></li><li class="dropdown-item"><!----> <a href="/mysql/基础SQL语句.html" class="nav-link">基础SQL语句</a></li><li class="dropdown-item"><!----> <a href="/mysql/.html" class="nav-link"></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Spring.html" class="nav-link">Spring</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">缓存</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Redis.html" class="nav-link">Redis</a></li></ul></div></div> <a href="https://github.com/EternalHao" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span></span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/%E4%BA%8B%E5%8A%A1.html#binlog日志" class="sidebar-link">binlog日志</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/mysql/%E4%BA%8B%E5%8A%A1.html#隐式-存在事务-commit" class="sidebar-link">隐式 存在事务 COMMIT</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/mysql/%E4%BA%8B%E5%8A%A1.html#不好的事务习惯-亮点" class="sidebar-link">不好的事务习惯 亮点</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>经典必问
问到事务这块你就扯这些</p></blockquote> <h3 id="_1-数据库的事务你了解多少"><a href="#_1-数据库的事务你了解多少" class="header-anchor">#</a> 1. 数据库的事务你了解多少?</h3> <blockquote><p>事务是数据库区别于文件系统的一个重要特性之一(其实就和git差不多),首先事务是InnoBD存储引擎特有的,通过START TRANSACTION,BEGIN 开启事务,通过COMMIT命令提交事务,如果需要回滚事务就需要ROLLBACK命令回滚事务,当然,MYSQL的事务默认是自动提交的,可以通过SET AUTOCOMMIT来改变,提到事务就不得不提他的隔离级别和它的四个特性.(其实这都是废话,重要的引出下面的事务隔离级别)</p></blockquote> <blockquote><p>1.特性描述</p></blockquote> <ol><li>原子性: 事务是一个原子操作单元,其对数据的修改,要么全部成功要么全部失败</li> <li>一致性: 在事务开始和完成时,数据必须保证一致的状态</li> <li>隔离性: 这个举个例子就是我的操作不能影响你的操作,事务直接相互隔离 主要实现的并发控制</li> <li>持久性: 事务在完成后,它对于数据的修改是永久性的,保存到数据库</li></ol> <blockquote><p>2.并发问题描述:</p></blockquote> <ul><li>脏读（Dirty Reads）：
事务A对一条记录发生了修改,但是这个事务还没有提交,这条记录的数据就处于不一致的状态,事务B此时读取就读取到了事务A未提交的数据.</li> <li>不可重复读（Non-Repeatable Reads）：
事务A在读取数据的时候,这条数据已经发生了改变,或者记录已经被删除</li> <li>幻读（Phantom Reads）：
事务A按照一定查询条件读取到数据,再进行一次重新的读取后发现事务B插入了新的数据</li></ul> <p>这时停顿一下,面试官可能让你继续说,你就开始巴巴,隔离级别怎么也要说个10分钟把,毕竟是你精心准备</p> <blockquote><p>3.事务隔离级别:</p></blockquote> <blockquote><p>事务的隔离级别机制主要是用来解决 <code>脏读、不可重复读、幻读</code>(这块一定要引出这个话题),出现这些问题的原因在于出现了并发事务,也就是不止一个事务操纵同一个数据行,为了降低并发带来的副作用,换句话说如果只有一个事务是没有这些问题的,在不同的隔离级别下可以解决不同的问题,隔离级别主要有四种</p></blockquote> <ol><li>读未提交 存在 存在 存在</li> <li>读已提交 解决 存在 存在</li> <li>可重复读 解决 解决 存在</li> <li>可序列化 解决 解决 解决
数据库默认的隔离级别是 可重复读</li></ol> <p>说完这个此时再引出 隔离级别的实现方式</p> <blockquote><p>4.隔离级别的实现方式</p></blockquote> <blockquote><p>要实现事务的隔离级别,其实就是解决事务的并发问题,解决并发问题,通常的处理方法就是加锁,在事务开始的时候加锁,提交或回滚的时候释放锁,但是MySql还提供了一种不加锁的方式-那就是大名定定的MVCC,全称叫做多版本控制(说到这里停顿一下,看面试官的反应)</p></blockquote> <p>以下会出现大概率的问你 什么是MVCC,那你赚到了,毕竟我们准备了</p> <blockquote><p>介绍MVCC
在MVCC并发控制中，读操作可以分成两类：快照读 (snapshot read)与当前读 (current read)。快照读，读取的是记录的可见版本 (有可能是历史版本)，不用加锁。当前读，读取的是记录的最新版本，并且，当前读返回的记录，都会加上锁，保证其他事务不会再并发修改这条记录</p></blockquote> <p>没有问道你也可以自告奋勇,你可以这样说,我了解一点MVCC原理,还有一些问题想和面试官讨论,80%的面试官是不会拒绝你的,那你就可以开始巴巴啦</p> <p>事务实现的方式是由两种日志做到的
redo 重做日志 保证事务的原子性和持久性
undo 重写日志 提供日志回滚和MVCC功能</p> <h3 id="_2-简单介绍一下分布式事务-这个可能是一个重点-此处因该结合具体的业务场景"><a href="#_2-简单介绍一下分布式事务-这个可能是一个重点-此处因该结合具体的业务场景" class="header-anchor">#</a> 2. 简单介绍一下分布式事务(这个可能是一个重点,此处因该结合具体的业务场景)</h3> <p>被问到这个问题,你又赚打发了,具体回答查看连接</p> <blockquote><p>使用分布式事务的应用程序涉及一个资源管理器(RM)和一个事务管理器(TN),对于MySQL来说,资源管理器就是MySQL,事务管理器就是连接MySQL的客户端,分布式事务采用两阶段提交的方式,
两阶段提交
在第一个阶段: 告知TM要准备提交
在第二个阶段: TM告知RM是否要提交或回滚</p></blockquote> <p>分布式事务是基于 XA事务模型的,所用的命令是XA START,XA PREPARE</p> <hr> <p>一下内容为进阶操作,自己酌情处理</p> <h1 id="事务的进阶操作-加分项"><a href="#事务的进阶操作-加分项" class="header-anchor">#</a> 事务的进阶操作 加分项</h1> <p>事务的分类:</p> <ol><li><p>扁平事务 保存点默认未开始的地方
我回家的例子</p></li> <li><p>带有保存点的事务</p></li> <li><p>链事务 保存点模式的一种变种</p></li> <li><p>嵌套事务 事务层级状态</p></li> <li><p>分布式事务</p></li></ol> <h2 id="binlog日志"><a href="#binlog日志" class="header-anchor">#</a> binlog日志</h2> <p>用来主从同步</p> <h2 id="隐式-存在事务-commit"><a href="#隐式-存在事务-commit" class="header-anchor">#</a> 隐式 存在事务 COMMIT</h2> <ol><li>DDL语句</li> <li>修改MySQL架构操作</li> <li>管理语句</li></ol> <h2 id="不好的事务习惯-亮点"><a href="#不好的事务习惯-亮点" class="header-anchor">#</a> 不好的事务习惯 亮点</h2> <ol><li><p>在循环中提交</p></li> <li><p>使用自动提交</p></li> <li><p>使用自动回滚</p></li> <li><p>长事务
执行时间比较长的事务</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.702528d9.js" defer></script><script src="/assets/js/2.bc0a9366.js" defer></script><script src="/assets/js/19.8eac0218.js" defer></script>
  </body>
</html>
